<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>tab切换</title>

    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link href="https://cdn.bootcss.com/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
    <!-- 引入 echarts.js -->
    <script type="text/javascript" src="/js/echarts.min.js"></script>
</head>
<body>
<div>

    <!-- 导航 -->
    <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#all" aria-controls="all" role="tab"
                                                  data-toggle="tab">全部</a></li>
        <li role="presentation"><a href="#daily" aria-controls="daily" role="tab" data-toggle="tab" onclick="clickDaily()">日</a></li>
        <li role="presentation"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">Messages</a>
        </li>
        <li role="presentation"><a href="#settings" aria-controls="settings" role="tab" data-toggle="tab">Settings</a>
        </li>
    </ul>

    <!-- 对应内容 -->
    <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="all">...1</div>
        <div role="tabpanel" class="tab-pane" id="daily">
            <!--            <div style="overflow-x:auto;width: 414px;">-->
            <!--                <div id="daily1" style="width: 414px;height:400px;"></div>-->
            <!--            </div>-->

            <div id="daily1" style="width: 400px;height:400px;"></div>

            <b id="daily_date" ></b>
            <h4 id="daily_score"><font color="#9a4141"></font></h4>
            <div class="row">
                <div class="col-md-4 col-lg-4 col-sm-4 col-xs-4 text-center a" >累计(天)</div>
                <div class="col-md-4 col-lg-4 col-sm-4 col-xs-4 text-center a" >累计(组)</div>
                <div class="col-md-4 col-lg-4 col-sm-4 col-xs-4 text-center a" >总共(次)</div>
            </div>
            <div class="row">
                <div class="col-md-4 col-lg-4 col-sm-4 col-xs-4 text-center a" >1</div>
                <div class="col-md-4 col-lg-4 col-sm-4 col-xs-4 text-center a" >11</div>
                <div class="col-md-4 col-lg-4 col-sm-4 col-xs-4 text-center a" >111</div>
            </div>

            <b>2021年2月8日星期一</b>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >顶桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >3 60</div>
            </div>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >高低桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >2 100</div>
            </div>

            <b>2021年2月7日星期一</b>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >顶桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >4 60</div>
            </div>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >直 桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >2 100</div>
            </div>

            <b>2021年2月7日星期一</b>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >顶桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >4 60</div>
            </div>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >直 桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >2 100</div>
            </div>

            <b>2021年2月7日星期一</b>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >顶桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >4 60</div>
            </div>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >直 桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >2 100</div>
            </div>

            <b>2021年2月7日星期一</b>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >顶桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >4 60</div>
            </div>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >直 桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >2 100</div>
            </div>

            <b>2021年2月7日星期一</b>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >顶桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >4 60</div>
            </div>
            <div class="row">
                <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2 text-center a" >直 桥</div>
                <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 text-center a" ></div>
                <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3 text-center a" >2 100</div>
            </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="messages">...3</div>
        <div role="tabpanel" class="tab-pane" id="settings">...4</div>
    </div>
</div>

<script type="text/javascript">
    function clickDaily() {
        // paint();
        var dailyScores = [];
        var dates = [];
        var shortDates = [];
        var dailyLogs = query();
        for(var i = 0; i < dailyLogs.stats.length; i++) {
            dailyScores.push(dailyLogs.stats[i].scores)
            shortDates.push(dailyLogs.stats[i].fitDate.substr(5))
            dates.push(dailyLogs.stats[i].fitDate)
        }

        paintDaily(shortDates, dailyScores, dates)
    }

    function query(){
        var result;
        $.ajax({
            type : "POST",
            // contentType: "application/json;charset=UTF-8",
            url : "get/logs",
            async:false,
            data : {},
            success: function(result1) {
                result = result1;
            },
            error: function(e){
                console.log(e.status);
                console.log(e.responseText);
            }
        });

        return result;
    }

    function paintDaily(shortDates, dailyScores, dates){
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('daily1'));

        // 指定图表的配置项和数据
        option = {
            title: {
                text: '运动量',
                subtext: 'subtext'
            },
            xAxis: {
                data: shortDates,
                axisLabel: {
                    textStyle: {
                        color: 'gray'
                    }
                },
                axisTick: {
                    show: false
                },
                axisLine: {
                    show: false
                },
                z: 10
            },
            yAxis: {
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    textStyle: {
                        color: '#999'
                    }
                }
            },
            dataZoom: [
                {
                    type: 'inside',
                    startValue: Math.max(0, dailyScores.length - 10),
                    endValue: dailyScores.length - 1
                }
            ],
            series: [
                {
                    type: 'bar',
                    showBackground: true,
                    backgroundStyle: {
                        // color: 'rgba(22,208,144,0.15)'
                        color: 'black'//设置无效，why
                    },
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                {offset: 0, color: '#83bff6'},
                                {offset: 0.5, color: '#188df0'},
                                {offset: 1, color: '#188df0'}
                            ]
                        )
                    },
                    emphasis: {
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(
                                0, 0, 0, 1,
                                [
                                    {offset: 0, color: '#2378f7'},
                                    {offset: 0.7, color: '#2378f7'},
                                    {offset: 1, color: '#83bff6'}
                                ]
                            )
                        }
                    },
                    data: dailyScores
                }
            ]
        };

        // myChart.on('click', function(params) {
        //     console.log(params);
        //     var name = parseInt(params.name);
        // });

        // var clickIndex;
        myChart.getZr().on('click', function(params) {
            var pointInPixel = [params.offsetX, params.offsetY]
            if (myChart.containPixel('grid', pointInPixel)) {
                var xIndex = myChart.convertFromPixel({ seriesIndex: 0 }, [params.offsetX, params.offsetY])[0]
                console.log(xIndex)
                document.getElementById('daily_date').innerHTML = formatDate(dates[xIndex])
                document.getElementById('daily_score').innerHTML = dailyScores[xIndex] + "分"
                // document.getElementById('daily_date').innerHTML = dailyScores[xIndex]
                // clickIndex=xindex
                // document.getElementById('daily_date')
            }
        });

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        myChart.resize();

        // document.getElementById('daily_date')
    }

    function formatDate(date) {
        var y = new Date(date);
        return y.getFullYear() + "年" + (y.getMonth()+1) + "月" + y.getDate() + "日";
    }

    function formatDateWithWeekday(date) {
        var y = new Date(date);
        return y.getFullYear() + "年" + (y.getMonth()+1) + "月" + y.getDate() + "日 " + getWeekDay(y.getDate());
    }

    function getWeekDay(date){
        var week;
        if(date.getDay()==0) week="星期天"
        if(date.getDay()==1) week="星期一"
        if(date.getDay()==2) week="星期二"
        if(date.getDay()==3) week="星期三"
        if(date.getDay()==4) week="星期四"
        if(date.getDay()==5) week="星期五"
        if(date.getDay()==6) week="星期六"
        return week;
    }

    // function paint(){
    //     // 基于准备好的dom，初始化echarts实例
    //     var myChart = echarts.init(document.getElementById('daily'));
    //
    //     // 指定图表的配置项和数据
    //     var option = {
    //         title: {
    //             text: 'ECharts 入门示例'
    //         },
    //         tooltip: {},
    //         legend: {
    //             data:['得分']
    //         },
    //         xAxis: {
    //             data: ["哈登","杜兰特","戴维斯","詹姆斯","阿德托昆博","恩比德","利拉德","沃克","伦纳德","拉文"]
    //         },
    //         yAxis: {},
    //         series: [{
    //             name: '得分',
    //             type: 'bar',
    //             data: [30.6, 30.0, 28.2, 27.8, 27.6, 27.0,27.0,26.5,25.5,25.0]
    //         }]
    //     };
    //     // 使用刚指定的配置项和数据显示图表。
    //     myChart.setOption(option);
    // }

</script>
</body>
</html>